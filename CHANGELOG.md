# 身份证验证系统 ChangeLog

此ChangeLog记录了身份证验证系统从初始版本到最终稳定版的所有主要变更和改进。

## v1.4.0-rc - 图标支持与打包优化
### 新增功能
- **程序图标支持**：
  - 添加窗口图标和任务栏图标支持
  - 支持开发环境和打包环境自动加载图标
  - 添加图标文件 `icon.ico`
- **打包配置优化**：
  - 更新PyInstaller spec文件以包含图标资源
  - 支持生成带自定义图标的可执行文件 `.exe`

### 技术实现
- 使用 `sys._MEIPASS` 处理打包环境资源路径
- 添加异常处理确保图标加载失败不影响程序运行

## v1.3.1-beta - 界面布局优化
### 主要变更
- **输入区域重构**：
  - 重新设计输入区域布局，解决拉伸问题
  - 使用弹性布局实现输入框自适应
- **结果展示优化**：
  - 使用字典存储信息标签，简化标签更新
  - 优化信息项对齐和间距
- **验证逻辑改进**：
  - 合并所有校验到 `check_all()` 方法
  - 统一错误提示为"身份证格式或内容有误"

### 界面调整
- 简化颜色方案，使用系统默认色调
- 移除自定义颜色变量
- 优化状态栏文本内容

## v1.3.0-beta - 面向对象重构版
### 架构重构
- **类封装**：
  - 创建 `IDValidatorApp` 类封装整个应用
  - 使用实例变量存储GUI组件
- **模块化设计**：
  - `create_widgets()` - 主界面创建
  - `create_input_frame()` - 输入区域
  - `create_result_frame()` - 结果区域
  - `create_status_bar()` - 状态栏
- **方法封装**：
  - `validate_id_card()` - 静态方法，身份证验证
  - `extract_info()` - 静态方法，信息提取
  - `find_region_info()` - 静态方法，行政区查询
  - `on_validate()` - 实例方法，验证事件处理
- **入口优化**：
  - 使用 `if __name__ == "__main__":` 启动应用

## v1.2.2-beta - 错误处理简化版
### 主要变更
- ** 统一错误提示 **：
- 所有验证错误返回统一消息："身份证号码无效，请检查输入！"
- ** 代码精简 **：
- 合并多个验证错误返回点
- 使用列表推导式简化校验码计算
- 简化闰年判断逻辑
- ** GUI优化 **：
- 使用lambda函数简化悬停效果
- 精简代码结构

## v1.2.0-beta | v1.2.1-beta - 功能增强版
### 新增功能
- **日期范围验证**：
  - 年份必须大于1840
  - 月份验证（1-12）
  - 日期验证（考虑月份天数和闰年）
- **回车键支持**：
  - 绑定回车键触发验证功能
- **状态栏更新**：
  - 添加"MIT License"提示
  
### 代码优化
- 日期格式化改进（使用普通空格替代特殊空格）
- 闰年判断逻辑优化

## v1.1.4-beta - 按钮悬停效果
- 为验证按钮添加鼠标悬停高光效果
- 定义悬停颜色 (`#3399ff`)
- 实现鼠标事件绑定：
  ```python
  validate_btn.bind("<Enter>", on_enter)
  validate_btn.bind("<Leave>", on_leave)
  ```

## v1.1.3-beta - 出生日期格式优化
- 修改出生日期显示格式
- 从"1970年01月01日"改为"1970年1月1日"
- 去除月份和日期的前导零

## v1.1.2-beta - 数据存储优化
- 移除 Excel 文件依赖
- 创建 idCode.py 存储行政区划数据
- 简化查找函数，直接读取内存数据
- 移除 pandas 依赖

## v1.1.1-beta - 代码注释优化
- 为所有函数添加详细文档字符串
- 关键代码段添加行内注释
- 优化代码结构，增加可读性
- 添加模块说明和版本信息

## v1.1.0-beta - 更新稳定版
### 1. 修复 Excel 文件读取问题
- **添加绝对路径支持**：确保能找到 Excel 文件
  ```python
  script_dir = os.path.dirname(os.path.abspath(__file__))
  excel_path = os.path.join(script_dir, 'idCode.xlsx')
  df = pd.read_excel(excel_path)
  ```
- **处理数据类型**：将行政区划代码转换为字符串并去除空格
- **处理空值**：使用 `pd.notna()` 正确检查空值
  ```python
  province = match.iloc[0]['省级'] if pd.notna(match.iloc[0]['省级']) else "-"
  ```

### 2. 添加后备数据
当 Excel 文件读取失败时，使用内置数据作为后备方案：

### 3. 优化错误处理
- **详细错误日志**：打印错误信息帮助调试
- **返回默认值**：当查找失败时返回"-"而不是"未知"

### 4. 其他改进
- **导入 os 模块**：用于处理文件路径
- **保持界面不变**：所有界面元素和布局保持不变
- **保留自动换行功能**：长行政区划名称仍能正确显示

## v1.0.5-beta - 优化状态栏显示
- 彻底解决状态栏被遮挡问题
- 增加窗口最小高度至 480px
- 增大状态栏内边距 (`pady=8`)
- 优化整体布局框架

## v1.0.4-beta - 简化错误提示
- 合并所有格式错误提示为"身份证号码格式错误，请检查输入！"
- 校验码错误提示改为"身份证号码无效，请检查输入！"
- 移除详细校验码错误信息

## v1.0.3-beta - 修复信息重复显示
- 分离信息标签和值标签
- 修复验证时信息重复显示的问题
- 优化行间距布局

## v1.0.2-beta - 支持长地名显示
- 添加自动换行功能 (`wraplength=350`)
- 支持滚动条查看长内容
- 优化状态栏显示（增加内边距）
- 窗口高度增加至 500px

## v1.0.1-beta - 解决显示问题
- 修复信息显示不全问题
- 优化信息布局为三行两列格式：
  ```
  性别:   出生: 
  省份:   地市: 
  县区:   来源: 
  ```
- 增加窗口高度至 350px

## v1.0.0-beta - 初始版本
- 初始实现身份证验证系统
- 基本功能：验证身份证有效性，提取出生日期、性别
- 使用 Excel 文件存储行政区划数据
- 简单 GUI 界面设计
